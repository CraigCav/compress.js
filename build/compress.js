!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Compress=e():t.Compress=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var i,r,a;!function(o,u){r=[t,n(1),n(2),n(3),n(4),n(5)],i=u,a="function"==typeof i?i.apply(e,r):i,!(void 0!==a&&(t.exports=a))}(this,function(t,e,n,i,r,a){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function u(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var s=o(e),d=o(n),f=o(i),l=o(r),c=o(a),h=function(){function t(t,n){return new Promise(function(i,r){var a=document.querySelector(t);a.setAttribute("accept","image/*"),a.addEventListener("change",function(t){var r=e([].concat(u(t.target.files)),n);i(r)},!1)})}function e(t,e){return Promise.all(t.map(function(t){return n(t,e)}))}function n(t,e){var n=new c.default(e);return n.start=performance.now(),n.alt=t.name,n.ext=t.type,n.startSize=t.size,f.default.load(t).then(i(n))}function i(t){return function(e){return l.default.load(e).then(function(e){if(t.startWidth=e.naturalWidth,t.startHeight=e.naturalHeight,t.resize){var n=l.default.resize(t.maxWidth,t.maxHeight)(e.naturalWidth,e.naturalHeight),i=n.width,r=n.height;t.endWidth=i,t.endHeight=r}else t.endWidth=e.naturalWidth,t.endHeight=e.naturalHeight;return d.default.imageToCanvas(t.endWidth,t.endHeight)(e)}).then(function(e){return t.iterations=1,t.base64prefix=s.default.prefix(s.default.mime(d.default.canvasToBase64(e))),r(e,t.startSize,t.quality,t.size,t.minQuality,t.iterations)}).then(function(e){return t.finalSize=s.default.size(e),s.default.data(e)}).then(function(e){t.end=performance.now();var n=t.end-t.start;return{data:e,prefix:t.base64prefix,elapsedTime:n/1e3,alt:t.alt,initialSize:d.default.size(t.startSize).MB,endSize:d.default.size(t.finalSize).MB,ext:t.ext,quality:t.quality,endWidth:t.endWidth,endHeight:t.endHeight,initialWidth:t.startWidth,initialHeight:t.startHeight,sizeReduced:(t.startSize-t.finalSize)/t.startSize*100,iterations:t.iterations}})}}function r(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments[5],u=d.default.canvasToBase64(t),f=s.default.size(u);return o+=1,f>i?r(t,f,n-.1,a,i,o):n>a?r(t,f,n-.1,a,i,o):n<.5?u:u}return{compress:e,attach:t}};t.exports=h})},function(t,e,n){var i,r,a;!function(n,o){r=[e],i=o,a="function"==typeof i?i.apply(e,r):i,!(void 0!==a&&(t.exports=a))}(this,function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=function(t){var e=t.replace(/^data:image\/\w+;base64,/,"").length;return(e-814)/1.37},n=function(t){return t.split(";")[0].match(/jpeg|png|gif/)[0]},i=function(t){return t.replace(/^data:image\/\w+;base64,/,"")},r=function(t){return"data:"+t+";base64,"};t.default={size:e,mime:n,data:i,prefix:r}})},function(t,e,n){var i,r,a;!function(n,o){r=[e],i=o,a="function"==typeof i?i.apply(e,r):i,!(void 0!==a&&(t.exports=a))}(this,function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=function(t){for(var e=window.atob(t),n="image/jpeg",i=[],r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return new window.Blob([new Uint8Array(i)],{type:n})},n=function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,function(t){var e=n.getContext("2d");return e.drawImage(t,0,0,n.width,n.height),n}},i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.75,n=t.toDataURL("image/jpeg",e);return n},r=function(t){return{KB:t/1e3,MB:t/1e6}};t.default={base64ToFile:e,imageToCanvas:n,canvasToBase64:i,size:r}})},function(t,e,n){var i,r,a;!function(n,o){r=[e],i=o,a="function"==typeof i?i.apply(e,r):i,!(void 0!==a&&(t.exports=a))}(this,function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=function(t){return new Promise(function(e,n){var i=new FileReader;i.addEventListener("load",function(t){e(t.target.result)},!1),i.addEventListener("error",function(t){n(t)},!1),i.readAsDataURL(t)})};t.default={load:e}})},function(t,e,n){var i,r,a;!function(n,o){r=[e],i=o,a="function"==typeof i?i.apply(e,r):i,!(void 0!==a&&(t.exports=a))}(this,function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=function(t){return new Promise(function(e,n){var i=new Image;i.addEventListener("load",function(){e(i)},!1),i.addEventListener("error",function(t){n(t)},!1),i.src=t})},n=function(t,e){return function(n,i){if(!t&&!e)return{width:n,height:i};var r=Math.min(n,t),a=Math.min(i,e);if(r){var o=n/r,u=i/o;return{width:r,height:u}}var s=i/a,d=n/s;return{width:d,height:a}}};t.default={load:e,resize:n}})},function(t,e,n){var i,r,a;!function(n,o){r=[e],i=o,a="function"==typeof i?i.apply(e,r):i,!(void 0!==a&&(t.exports=a))}(this,function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function t(n){var i=n.quality,r=void 0===i?.75:i,a=n.size,o=void 0===a?2:a,u=n.maxWidth,s=void 0===u?1920:u,d=n.maxHeight,f=void 0===d?1920:d,l=n.resize,c=void 0===l||l;e(this,t),this.start=performance.now(),this.end=null,this.alt=null,this.ext=null,this.startSize=null,this.startWidth=null,this.startHeight=null,this.size=1e3*o*1e3,this.endSize=null,this.endWidth=null,this.endHeight=null,this.iterations=0,this.base64prefix=null,this.quality=r,this.resize=c,this.maxWidth=s,this.maxHeight=f};t.default=n})}])});
//# sourceMappingURL=compress.js.map